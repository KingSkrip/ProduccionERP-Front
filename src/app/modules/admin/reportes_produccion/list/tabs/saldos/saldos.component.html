<!-- Cards de resumen - Solo mostrar si hay datos -->
<div class="md:px-8 md:py-4" *ngIf="!isLoadingSaldos && datosSaldosFiltrados.length > 0">
    <!-- Vista móvil -->
    <div class="md:hidden">
        <div class="bg-card shadow-sm rounded-xl px-5 py-4 border-l-4 border-emerald-500">
            <div class="flex items-center justify-between gap-4">
                <div class="flex-1 min-w-0">
                    <div class="text-sm font-medium text-secondary mb-2">
                        Total Saldos
                    </div>
                    <div class="flex items-baseline gap-2">
                        <div class="text-3xl font-bold">
                            {{ calcularTotalPesoSaldos() | number:'1.0-0' }}
                        </div>
                        <div class="text-sm text-secondary">kg</div>
                    </div>
                </div>
                <div class="flex-shrink-0">
                    <div class="w-12 h-12 rounded-lg bg-emerald-500/10 flex items-center justify-center">
                        <mat-icon class="text-emerald-500 icon-size-6" 
                            [svgIcon]="'heroicons_solid:archive-box'"></mat-icon>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Vista desktop -->
    <div class="hidden md:grid grid-cols-3 gap-3">
        <div class="bg-card shadow-sm rounded-xl p-4 border-l-4 border-emerald-500">
            <div class="flex items-center justify-between mb-1">
                <div class="text-base text-secondary">Total Saldos</div>
                <mat-icon class="text-emerald-500 icon-size-5" [svgIcon]="'heroicons_solid:scale'"></mat-icon>
            </div>
            <div class="text-2xl font-bold">{{ calcularTotalPesoSaldos() | number:'1.0-0' }}</div>
            <div class="text-sm text-secondary">Kilogramos</div>
        </div>

        <div class="bg-card shadow-sm rounded-xl p-4 border-l-4 border-blue-500">
            <div class="flex items-center justify-between mb-1">
                <div class="text-base font-medium text-secondary">Total Artículos</div>
                <mat-icon class="text-blue-500 icon-size-5" [svgIcon]="'heroicons_solid:cube'"></mat-icon>
            </div>
            <div class="text-2xl font-bold">{{ contarArticulosSaldos() }}</div>
            <div class="text-sm text-secondary">Artículos con saldo</div>
        </div>

        <div class="bg-card shadow-sm rounded-xl p-4 border-l-4 border-purple-500">
            <div class="flex items-center justify-between mb-1">
                <div class="text-base font-medium text-secondary">Total Piezas</div>
                <mat-icon class="text-purple-500 icon-size-5" [svgIcon]="'heroicons_solid:chart-bar'"></mat-icon>
            </div>
            <div class="text-2xl font-bold">{{ calcularTotalPiezasSaldos() | number:'1.0-0' }}</div>
            <div class="text-sm text-secondary">Piezas en saldo</div>
        </div>
    </div>
</div>

<!-- Loading State -->
<div *ngIf="isLoadingSaldos" class="flex flex-col items-center justify-center py-16 px-4">
    <div class="w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mb-4"></div>
    <p class="text-secondary">Cargando datos de saldos...</p>
</div>

<!-- Empty State - Cuando no hay resultados con los filtros aplicados -->
<div *ngIf="!isLoadingSaldos && datosSaldosFiltrados.length === 0 && cargaInicial" 
    class="flex flex-col items-center justify-center py-16 px-4">
    <div class="relative mb-6">
        <div class="w-24 h-24 rounded-2xl bg-cyan-400/10 flex items-center justify-center">
            <mat-icon class="icon-size-12 text-cyan-500/40" 
                [svgIcon]="'heroicons_outline:archive-box'"></mat-icon>
        </div>
    </div>
    
    <h3 class="text-xl font-bold mb-2">Sin saldos</h3>
    <p class="text-secondary text-center max-w-md mb-4">
        No se encontraron registros con los filtros seleccionados.
        <br>Intenta ajustar tus criterios de búsqueda o seleccionar otro periodo.
    </p>
    
    <button mat-stroked-button class="rounded-xl" (click)="limpiarFiltrosLocales()">
        <mat-icon class="icon-size-5 mr-2" [svgIcon]="'heroicons_solid:arrow-path'"></mat-icon>
        Limpiar filtros
    </button>
</div>

<!-- Tabla de datos -->
<div class="mt-6 overflow-x-auto md:px-8" *ngIf="!isLoadingSaldos && datosSaldosFiltrados.length > 0">
    <table class="w-full bg-card shadow-sm rounded-2xl overflow-hidden">
        <thead class="bg-gray-50 dark:bg-gray-800">
            <tr>
                <th class="px-3 py-2 md:px-6 md:py-4 text-left text-sm md:text-base font-semibold tracking-wider">
                    Artículo
                </th>
                <th class="px-3 py-2 md:px-6 md:py-4 text-right text-sm md:text-base font-semibold tracking-wider">
                    Piezas
                </th>
                <th class="px-3 py-2 md:px-6 md:py-4 text-right text-sm md:text-base font-semibold tracking-wider">
                    Peso Saldo (kg)
                </th>
            </tr>
        </thead>
        <tbody class="divide-y">
            <tr *ngFor="let item of datosSaldosFiltrados"
                class="hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors">
                <td class="px-3 py-2 md:px-6 md:py-4">
                    <div class="flex items-center gap-3">
                        <mat-icon class="icon-size-5 text-emerald-500 flex-shrink-0"
                            [svgIcon]="'heroicons_solid:archive-box'"></mat-icon>
                        <span class="font-semibold">{{ item.ARTICULO }}</span>
                    </div>
                </td>
                <td class="px-3 py-2 md:px-6 md:py-4 text-right">
                    <span class="font-bold text-purple-600 dark:text-purple-400 text-lg">
                        {{ item.PIEZAS | number:'1.0-0' }}
                    </span>
                </td>
                <td class="px-3 py-2 md:px-6 md:py-4 text-right">
                    <span class="font-bold text-emerald-600 dark:text-emerald-400 text-lg">
                        {{ item.TOTAL_SALDO | number:'1.2-2' }}
                    </span>
                </td>
            </tr>
        </tbody>
        <tfoot class="bg-gray-50 dark:bg-gray-800 font-bold border-t-2">
            <tr>
                <td class="px-3 py-2 md:px-6 md:py-4 text-right text-base">
                    Total:
                </td>
                <td class="px-3 py-2 md:px-6 md:py-4 text-right">
                    <span class="text-lg text-purple-600 dark:text-purple-400">
                        {{ calcularTotalPiezasSaldos() | number:'1.0-0' }}
                    </span>
                </td>
                <td class="px-3 py-2 md:px-6 md:py-4 text-right">
                    <span class="text-lg text-emerald-600 dark:text-emerald-400">
                        {{ calcularTotalPesoSaldos() | number:'1.2-2' }}
                    </span>
                </td>
            </tr>
        </tfoot>
    </table>
</div>